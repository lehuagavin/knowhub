# 第四章 架构方法论 - 习题

## 一、选择题

### 1. 关于微服务拆分，以下哪个不是合适的拆分信号？
A. 团队规模超过10人，代码冲突频繁
B. 不同模块的发布节奏差异大
C. 团队只有3个人，但觉得微服务很流行
D. 某个模块需要独立扩容

### 2. 熔断器的三种状态依次是？
A. 打开 → 关闭 → 半开
B. 关闭 → 打开 → 半开
C. 半开 → 关闭 → 打开
D. 关闭 → 半开 → 打开

### 3. 以下哪种限流算法允许一定程度的突发流量？
A. 漏桶算法
B. 固定窗口计数器
C. 令牌桶算法
D. 以上都不允许

### 4. 关于缓存穿透，以下哪种方案不能解决该问题？
A. 缓存空值
B. 布隆过滤器
C. 增加缓存过期时间
D. 参数校验过滤非法请求

### 5. Kafka中，一个Topic有3个Partition，Consumer Group中有5个消费者，那么？
A. 每个消费者分配到至少一个Partition
B. 有2个消费者处于空闲状态
C. 系统会自动增加Partition到5个
D. 会报错无法启动

### 6. 关于蓝绿发布和金丝雀发布，以下说法正确的是？
A. 蓝绿发布需要双倍资源，金丝雀发布不需要
B. 金丝雀发布可以逐步验证新版本，蓝绿发布是全量切换
C. 蓝绿发布比金丝雀发布风险更低
D. 两种发布方式都需要停机

---

## 二、简答题

### 7. 请解释缓存击穿和缓存雪崩的区别，并分别给出解决方案。

### 8. 比较同步通信（HTTP/gRPC）和异步通信（消息队列）的优缺点，分别适用于什么场景？

### 9. 请描述Redis Sentinel的故障转移流程。为什么需要多个Sentinel节点？

### 10. 解释什么是"重试风暴"（Retry Storm），如何避免？

---

## 三、设计题

### 11. 限流系统设计
请设计一个分布式限流系统，要求：
- 支持按用户、按IP、按接口三个维度限流
- 支持配置不同的限流规则（如：用户A每秒100次，接口B每秒1000次）
- 在分布式环境下保证限流的准确性
- 请描述整体架构和关键实现细节

### 12. 消息队列选型
你的团队需要为以下三个场景选择消息队列方案，请分别给出选型建议并说明理由：
- 场景A：日志收集系统，每天处理100亿条日志
- 场景B：订单系统，需要事务消息保证订单和库存的一致性
- 场景C：即时通讯系统，需要毫秒级延迟
