---
import BaseLayout from '../layouts/BaseLayout.astro';
import HeroSection from '../components/sections/HeroSection.astro';
import StatsSection from '../components/sections/StatsSection.astro';
import TopicCard from '../components/cards/TopicCard.astro';
import ArticleCard from '../components/cards/ArticleCard.astro';
import { topics, getStats, getAllArticles, getTopicsSummary } from '../data/topics';
import { url } from '../utils/path';

const stats_data = getStats();
const topicsSummary = getTopicsSummary();
const recentArticles = getAllArticles().slice(0, 6);

const stats = [
  { value: `${stats_data.topicCount}`, label: 'çŸ¥è¯†ä¸»é¢˜' },
  { value: `${stats_data.articleCount}`, label: 'æŠ€æœ¯æ–‡ç« ' },
  { value: `${stats_data.tagCount}`, label: 'æ ‡ç­¾åˆ†ç±»' },
  { value: 'âˆ', label: 'æŒç»­æ›´æ–°' },
];
---

<BaseLayout
  title="é¦–é¡µ"
  description="çŸ¥è¯†åº“ - Rustã€å¤šæ¨¡æ€Agentã€Python ç­‰æŠ€æœ¯é¢†åŸŸçš„å­¦ä¹ ç¬”è®°ä¸æ–‡ç« æ±‡æ€»"
>
  <HeroSection
    title="çŸ¥è¯†åº“"
    subtitle="æ±‡èš Rustã€å¤šæ¨¡æ€Agentã€Python ç­‰é¢†åŸŸçš„å­¦ä¹ ç¬”è®°ä¸æŠ€æœ¯æ–‡ç« ï¼Œæ¢ç´¢æŠ€æœ¯å‰æ²¿ï¼Œæ²‰æ·€çŸ¥è¯†ä½“ç³»ã€‚"
    cta={{ text: 'å¼€å§‹æ¢ç´¢', href: '#topics' }}
    gradient={true}
    backgroundImage={url('/images/hero/hero-main.png')}
  />

  <StatsSection stats={stats} />

  <!-- çŸ¥è¯†æ±‡æ€» -->
  <section class="section" id="topics">
    <div class="container">
      <h2 class="section-title">çŸ¥è¯†æ±‡æ€»</h2>
      <p class="section-description">
        é€‰æ‹©æ„Ÿå…´è¶£çš„ä¸»é¢˜ï¼Œæ·±å…¥æ¢ç´¢æŠ€æœ¯çŸ¥è¯†
      </p>
      <div class="topics-grid">
        {topicsSummary.map((topic) => (
          <TopicCard {...topic} />
        ))}
      </div>
    </div>
  </section>

  <!-- æœ€æ–°æ–‡ç«  -->
  {recentArticles.length > 0 && (
    <section class="section recent-section">
      <div class="container">
        <h2 class="section-title">æœ€æ–°æ–‡ç« </h2>
        <p class="section-description">
          æœ€è¿‘æ›´æ–°çš„æŠ€æœ¯æ–‡ç« å’Œå­¦ä¹ ç¬”è®°
        </p>
        <div class="articles-grid">
          {recentArticles.map((article) => (
            <ArticleCard
              slug={article.slug}
              title={article.title}
              summary={article.summary}
              tags={article.tags}
              date={article.date}
              readingTime={article.readingTime}
              topicSlug={article.topicSlug}
              topicName={article.topicName}
              topicIcon={article.topicIcon}
              topicColor={article.topicColor}
              image={article.image}
            />
          ))}
        </div>
      </div>
    </section>
  )}

  <!-- ç©ºçŠ¶æ€æç¤º -->
  {recentArticles.length === 0 && (
    <section class="section empty-section">
      <div class="container">
        <div class="empty-state">
          <div class="empty-icon">ğŸ“</div>
          <h2 class="empty-title">æ–‡ç« æ­£åœ¨è·¯ä¸Š</h2>
          <p class="empty-description">
            çŸ¥è¯†åº“æ­£åœ¨å»ºè®¾ä¸­ï¼Œæ–‡ç« å°†é™†ç»­æ›´æ–°ã€‚æ•¬è¯·æœŸå¾…ï¼
          </p>
        </div>
      </div>
    </section>
  )}
</BaseLayout>

<style>
  .section {
    padding: var(--space-20) 0;
  }

  @media (min-width: 768px) {
    .section {
      padding: var(--space-24) 0;
    }
  }

  .section-title {
    text-align: center;
    font-size: clamp(2rem, 4vw, 3rem);
    margin-bottom: var(--space-4);
    color: var(--text-primary);
  }

  .section-description {
    text-align: center;
    font-size: 1.125rem;
    color: var(--text-secondary);
    max-width: 700px;
    margin: 0 auto var(--space-16);
    line-height: 1.6;
  }

  .topics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: var(--space-8);
  }

  @media (max-width: 640px) {
    .topics-grid {
      grid-template-columns: 1fr;
      gap: var(--space-6);
    }
  }

  .recent-section {
    background: var(--surface);
  }

  .articles-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: var(--space-6);
  }

  @media (max-width: 640px) {
    .articles-grid {
      grid-template-columns: 1fr;
    }
  }

  .empty-section {
    background: var(--surface);
  }

  .empty-state {
    text-align: center;
    padding: var(--space-16) 0;
  }

  .empty-icon {
    font-size: 4rem;
    margin-bottom: var(--space-6);
  }

  .empty-title {
    font-size: 1.75rem;
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: var(--space-3);
  }

  .empty-description {
    font-size: 1.125rem;
    color: var(--text-secondary);
    max-width: 500px;
    margin: 0 auto;
    line-height: 1.6;
  }
</style>
